import{f as F,_ as x,r as n,o as b,g as E,w as o,b as r,c as C,F as U,h as j,a as t,d as g,s as A,m as I,i as O,t as k}from"./app-f2b2cabb.js";import{u as q}from"./itemStore-737c839f.js";const L=F("categories",{state:()=>({categories:[],errors:{},isLoading:!1}),getters:{},actions:{async getCategories(){const l=await axios.get("/api/category");this.categories=l.data.data},async addCategory(l){try{this.isLoading=!0,this.errors=[],await axios.post("/api/category",l)}catch(e){console.log(e.message),this.errors=e.response.data.errors}finally{this.isLoading=!1,this.getCategories()}},async updateCategory(l,e){try{this.isLoading=!0,this.errors=[],await axios.put(`/api/category/${l}`,e)}catch(u){console.log(u.message),this.errors=u.response.data.errors}finally{this.isLoading=!1,this.getCategories()}}}}),z={props:["customAttribute"],emits:["change"],data(){return{dataTypes:["text","date","number"],attr:this.customAttribute??[],new_attr:{title:"",type:"text",value:null}}},methods:{saveAttr(){let l=this.new_attr;this.attr.push(JSON.parse(JSON.stringify(l))),this.new_attr={title:"",type:"text",value:null},this.$emit("change",this.attr)},deleteAttr(l){this.attr.splice(l,1),this.$emit("change",this.attr)}}},M=r("thead",null,[r("tr",null,[r("td",null,"Field"),r("td",null,"Type"),r("td")])],-1);function P(l,e,u,c,s,m){const d=n("v-text-field"),_=n("v-select"),f=n("v-icon"),v=n("v-table");return b(),E(v,null,{default:o(()=>[M,r("tbody",null,[(b(!0),C(U,null,j(s.attr,(i,h)=>(b(),C("tr",null,[r("td",null,[t(d,{modelValue:i.title,"onUpdate:modelValue":a=>i.title=a},null,8,["modelValue","onUpdate:modelValue"])]),r("td",null,[t(_,{modelValue:i.type,"onUpdate:modelValue":a=>i.type=a,items:s.dataTypes},null,8,["modelValue","onUpdate:modelValue","items"])]),r("td",null,[t(f,{onClick:a=>m.deleteAttr(h)},{default:o(()=>[g("mdi-close")]),_:2},1032,["onClick"])])]))),256)),r("tr",null,[r("td",null,[t(d,{modelValue:s.new_attr.title,"onUpdate:modelValue":e[0]||(e[0]=i=>s.new_attr.title=i)},null,8,["modelValue"])]),r("td",null,[t(_,{modelValue:s.new_attr.type,"onUpdate:modelValue":e[1]||(e[1]=i=>s.new_attr.type=i),items:s.dataTypes},null,8,["modelValue","items"])]),r("td",null,[t(f,{onClick:m.saveAttr},{default:o(()=>[g("mdi-plus")]),_:1},8,["onClick"])])])])]),_:1})}const T=x(z,[["render",P]]),R={components:{CustomAttribute:T},setup(){const l=L(),{errors:e,isLoading:u}=A(l);return{categoryStore:l,errors:e,isLoading:u}},data(){return{dialog:!1,form:{name:null,description:null},customAttributes:null}},methods:{async create(){this.categoryStore.addCategory({...this.form,json_attr:this.customAttributes}),Object.keys(this.errors).length||(this.dialog=!1,this.form={name:null,description:null},this.customAttributes=null)},handleCustomAttribute(l){this.customAttributes=JSON.stringify(l)}}},G=r("h1",{class:"text-subtitle-1"}," Custom Attributes ",-1);function H(l,e,u,c,s,m){const d=n("v-btn"),_=n("v-toolbar-title"),f=n("v-spacer"),v=n("v-toolbar-items"),i=n("v-toolbar"),h=n("v-text-field"),a=n("v-col"),w=n("CustomAttribute"),S=n("v-form"),V=n("v-row"),y=n("v-container"),B=n("v-card"),D=n("v-dialog");return b(),E(V,{justify:"start",class:"py-2"},{default:o(()=>[t(D,{modelValue:s.dialog,"onUpdate:modelValue":e[3]||(e[3]=p=>s.dialog=p),persistent:"",style:{"max-width":"30rem"},scrim:!1,transition:"dialog-bottom-transition"},{activator:o(({props:p})=>[t(d,I({color:"blue-lighten-1",dark:""},p,{"prepend-icon":"mdi-plus",class:"mr-10",size:"small"}),{default:o(()=>[g(" Add Category ")]),_:2},1040)]),default:o(()=>[t(B,null,{default:o(()=>[t(i,{color:"white",class:"border-b"},{default:o(()=>[t(_,null,{default:o(()=>[g("Create Category")]),_:1}),t(f),t(v,null,{default:o(()=>[t(d,{variant:"text",onClick:e[0]||(e[0]=p=>s.dialog=!1)},{default:o(()=>[g(" cancel ")]),_:1})]),_:1})]),_:1}),t(y,{style:{"max-width":"50rem"}},{default:o(()=>[t(V,null,{default:o(()=>[t(S,{style:{width:"100%"},onSubmit:O(m.create,["prevent"])},{default:o(()=>[t(a,{cols:"12"},{default:o(()=>{var p,N;return[t(h,{label:"Name*",modelValue:s.form.name,"onUpdate:modelValue":e[1]||(e[1]=J=>s.form.name=J),errors:!!((p=c.errors)!=null&&p.name),"error-messages":(N=c.errors)==null?void 0:N.name,required:""},null,8,["modelValue","errors","error-messages"])]}),_:1}),t(a,{cols:"12"},{default:o(()=>[t(h,{label:"Description",modelValue:s.form.description,"onUpdate:modelValue":e[2]||(e[2]=p=>s.form.description=p)},null,8,["modelValue"])]),_:1}),t(a,{cols:"12"},{default:o(()=>[G,t(w,{onChange:m.handleCustomAttribute},null,8,["onChange"])]),_:1}),t(a,{cols:"12"},{default:o(()=>[t(d,{block:"",variant:"flat",color:"blue-lighten-1",type:"submit",loading:c.isLoading},{default:o(()=>[g("Create Category")]),_:1},8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const K=x(R,[["render",H]]),Q={setup(){const l=L(),{errors:e,isLoading:u}=A(l);return{categoryStore:l,errors:e,isLoading:u}},props:{category:Object},emits:["change","close"],data(){return{dialog:!1,form:{name:this.category.name,description:this.category.description},customAttributes:JSON.parse(this.category.json_attr)}},methods:{async update(){await this.categoryStore.updateCategory(this.category.id,{...this.form,json_attr:this.customAttributes}),Object.keys(this.errors).length||(this.form={name:this.category.name,description:this.category.description},this.dialog=!1)},handleCustomAttribute(l){this.customAttributes=l}},components:{CustomAttribute:T}},W=r("h1",{class:"text-subtitle-1"},"Custom Attributes",-1);function X(l,e,u,c,s,m){const d=n("v-spacer"),_=n("v-btn"),f=n("v-card-actions"),v=n("v-text-field"),i=n("v-col"),h=n("CustomAttribute"),a=n("v-form"),w=n("v-row"),S=n("v-container"),V=n("v-card");return b(),E(V,null,{default:o(()=>[t(f,{"fixed-header":""},{default:o(()=>[g(" Update Category "),t(d),t(_,{fab:"",class:"bg-danger",icon:"mdi-close",onClick:e[0]||(e[0]=y=>l.$emit("close"))})]),_:1}),t(S,null,{default:o(()=>[t(w,null,{default:o(()=>[t(a,{style:{width:"100%"},onSubmit:O(m.update,["prevent"])},{default:o(()=>[t(i,{cols:"12"},{default:o(()=>[t(v,{label:"Name*",modelValue:s.form.name,"onUpdate:modelValue":e[1]||(e[1]=y=>s.form.name=y),error:c.errors.name,"error-messages":c.errors.name},null,8,["modelValue","error","error-messages"])]),_:1}),t(i,{cols:"12"},{default:o(()=>[t(v,{label:"Description",modelValue:s.form.description,"onUpdate:modelValue":e[2]||(e[2]=y=>s.form.description=y)},null,8,["modelValue"])]),_:1}),t(i,{cols:"12"},{default:o(()=>[W,t(h,{customAttribute:s.customAttributes,onChange:m.handleCustomAttribute},null,8,["customAttribute","onChange"])]),_:1}),t(i,{cols:"12"},{default:o(()=>[t(_,{block:"",variant:"flat",color:"blue-lighten-1",type:"submit",loading:c.isLoading},{default:o(()=>[g("Update Category")]),_:1},8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1})}const Y=x(Q,[["render",X]]),Z={async setup(){const l=L(),{categories:e}=A(l);await l.getCategories();const u=q(),{getItemCountByCategory:c}=A(u);return{categories:e,categoryStore:l,itemStore:u,getItemCountByCategory:c}},methods:{},data(){return{Editing:{dialog:!1,data:null}}},components:{Create:K,Edit:Y}},$={class:"actions"},tt=r("thead",null,[r("tr",null,[r("th",null,"Name"),r("th",null,"Description"),r("th",null,"Device Count"),r("th")])],-1);function et(l,e,u,c,s,m){const d=n("Create"),_=n("v-chip"),f=n("v-btn"),v=n("v-table"),i=n("Edit"),h=n("v-dialog");return b(),C(U,null,[r("div",$,[t(d)]),t(v,null,{default:o(()=>[tt,r("tbody",null,[(b(!0),C(U,null,j(c.categories,a=>(b(),C("tr",{key:a.id},[r("td",null,k(a.name),1),r("td",null,k(a.description),1),r("td",null,[t(_,null,{default:o(()=>[g(k(a.items_count),1)]),_:2},1024)]),r("td",null,[t(f,{fab:"",onClick:()=>{s.Editing.data=a,s.Editing.dialog=!0},icon:"mdi-pencil"},null,8,["onClick"])])]))),128))])]),_:1}),t(h,{modelValue:s.Editing.dialog,"onUpdate:modelValue":e[1]||(e[1]=a=>s.Editing.dialog=a),"full-screen":""},{default:o(()=>[t(i,{category:s.Editing.data,onClose:e[0]||(e[0]=a=>s.Editing.dialog=!1)},null,8,["category"])]),_:1},8,["modelValue"])],64)}const lt=x(Z,[["render",et]]);export{lt as default};
