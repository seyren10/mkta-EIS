import{u as C}from"./locationStore-c999e36b.js";import{_ as U,s as V,r as o,o as v,g as k,w as e,a as t,m as B,d,i as D,c as O,h as A,F as N,t as P,q as F,b as j}from"./app-f2b2cabb.js";import{u as I}from"./itemStore-737c839f.js";const T={setup(){const s=C(),{errors:n,isLoading:r,locations:a}=V(s);return{locationStore:s,errors:n,isLoading:r,locations:a}},props:{},data(){return{dialog:!1,form:{name:null}}},methods:{async create(){await this.locationStore.addLocation(this.form),Object.keys(this.errors).length||(this.dialog=!1,this.form={name:null})}}};function q(s,n,r,a,i,_){const m=o("v-btn"),g=o("v-toolbar-title"),b=o("v-spacer"),h=o("v-toolbar-items"),u=o("v-toolbar"),y=o("v-text-field"),x=o("v-col"),p=o("v-row"),w=o("v-form"),L=o("v-container"),l=o("v-card"),f=o("v-dialog");return v(),k(p,{justify:"start",class:"py-2"},{default:e(()=>[t(f,{modelValue:i.dialog,"onUpdate:modelValue":n[2]||(n[2]=c=>i.dialog=c),scrim:!1,transition:"dialog-bottom-transition",persistent:"",style:{"max-width":"30rem"}},{activator:e(({props:c})=>[t(m,B({color:"blue-lighten-1",dark:""},c,{"prepend-icon":"mdi-plus",size:"small"}),{default:e(()=>[d(" Add Location ")]),_:2},1040)]),default:e(()=>[t(l,null,{default:e(()=>[t(u,{color:"white",class:"border-b"},{default:e(()=>[t(g,null,{default:e(()=>[d("Add Location")]),_:1}),t(b),t(h,null,{default:e(()=>[t(m,{variant:"text",onClick:n[0]||(n[0]=c=>i.dialog=!1)},{default:e(()=>[d(" cancel ")]),_:1})]),_:1})]),_:1}),t(L,{style:{"max-width":"30rem"}},{default:e(()=>[t(w,{onSubmit:D(_.create,["prevent"])},{default:e(()=>[t(p,null,{default:e(()=>[t(x,{col:"12"},{default:e(()=>{var c,S;return[t(y,{label:"Location name",modelValue:i.form.name,"onUpdate:modelValue":n[1]||(n[1]=z=>i.form.name=z),errors:!!((c=a.errors)!=null&&c.name),"error-messages":(S=a.errors)==null?void 0:S.name,class:"mb-3"},null,8,["modelValue","errors","error-messages"]),t(m,{type:"submit",variant:"flat",color:"blue-lighten-1",class:"w-100",loading:a.isLoading},{default:e(()=>[d("Add")]),_:1},8,["loading"])]}),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const E=U(T,[["render",q]]),M={async setup(){const s=C();await s.getLocations();const n=I(),{locations:r,errors:a,isLoading:i}=V(s),{items:_}=V(n);return{locations:r,locationStore:s,errors:a,isLoading:i,items:_}},data(){return{}},components:{Create:E},methods:{async update(s){await this.locationStore.updateLocation(s.id,s),Object.keys(this.errors).length||(this.dialog=!1,this.form={name:null})},itemsPerLocationCount(s){return this.items.reduce((n,r)=>{var a;return r.employee_inventories&&((a=r.employee_inventories[0])==null?void 0:a.by_location.name)===s.name?n+=1:n},0)}}},R=j("span",{class:"text-caption"},"Deployed Devices:",-1),G={class:"justify-self-end"};function H(s,n,r,a,i,_){const m=o("Create"),g=o("v-text-field"),b=o("v-chip"),h=o("v-card-text"),u=o("v-btn"),y=o("v-list-item"),x=o("v-card-actions"),p=o("v-card"),w=o("v-row"),L=o("v-container");return v(),k(L,null,{default:e(()=>[t(m,{class:"mb-5"}),t(w,{style:{gap:"1rem"}},{default:e(()=>[(v(!0),O(N,null,A(a.locations,l=>(v(),k(p,{"max-width":"200",density:"compact",key:l.id,class:"w-100"},{default:e(()=>[t(h,{class:"text-h5 py-2"},{default:e(()=>[t(g,{modelValue:l.name,"onUpdate:modelValue":f=>l.name=f,readOnly:l.id===1,loading:a.isLoading},null,8,["modelValue","onUpdate:modelValue","readOnly","loading"]),R,t(b,{color:"blue-darken-1",size:"small"},{default:e(()=>[d(P(_.itemsPerLocationCount(l)),1)]),_:2},1024)]),_:2},1024),t(x,null,{default:e(()=>[t(y,{class:"w-100"},F({_:2},[l.id!==1?{name:"append",fn:e(()=>[j("div",G,[t(u,{"prepend-icon":"mdi-update",class:"text-none",variant:"outlined",color:"blue-lighten-1",size:"small",onClick:f=>_.update(l),loading:a.isLoading},{default:e(()=>[d("Update")]),_:2},1032,["onClick","loading"]),t(u,{"prepend-icon":"mdi-delete",class:"text-none",color:"red-lighten-1",variant:"flat",size:"small"},{default:e(()=>[d("Delete")]),_:1})])]),key:"0"}:void 0]),1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})}const W=U(M,[["render",H]]);export{W as default};
