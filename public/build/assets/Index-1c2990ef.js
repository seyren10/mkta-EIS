import{u as N}from"./itemStore-737c839f.js";import{u as j,A as P,C as z}from"./Associate-d56e3e23.js";import{_ as T,u as M,s as U,r,o as c,g as y,w as l,a as e,m as K,d as p,i as B,j as q,v as L,b as v,c as A,t as E,k as I,h as F,F as O,l as R}from"./app-f2b2cabb.js";import{V as G}from"./VDataTable-7163fc42.js";import"./employeeStore-4009d962.js";import"./locationStore-c999e36b.js";const H={setup(){const n=N(),o=M(),m=j(),{errors:i,isLoading:t}=U(n),{user:_}=U(o);return{errors:i,isLoading:t,itemStore:n,employeeInventoryStore:m,user:_}},props:{categories:Array},data(){return{dialog:!1,form:{brand:null,model:null,serial_no:null,mk_tag_no:null,date_purchased:new Date().toISOString().split("T")[0],accountability_no:null,category_id:this.categories.length?this.categories[0].id:"No Category Available",status:"good"},additionalData:{}}},watch:{"form.category_id":{handler(n){console.log(n);const o=this.categories.find(m=>m.id===n);o&&o.json_attr&&(this.additionalData=JSON.parse(o.json_attr))},immediate:!0}},methods:{async create(){const o=(await this.itemStore.postItem({...this.form,json_attr:JSON.stringify(this.additionalData)})).data.data,m={transferred_date:new Date().toISOString().split("T")[0],officer_in_charge:this.user?this.user.name:"anonymous",is_active:1,item_id:o.id,employee_id:1,location_id:1};await this.employeeInventoryStore.postEmployeeInventories(m),Object.keys(this.errors).length||(this.form={brand:null,model:null,serial_no:null,mk_tag_no:null,date_purchased:new Date().toISOString().split("T")[0],accountability_no:null,category_id:this.categories.length?1:"No Category Available",condition:"good"},this.additionalData={},this.dialog=!1)}}},Q=v("label",{for:"date"},"Purchased Date*",-1),W={key:0},X=v("h3",{class:"text-overline"},"Additional Data",-1);function Y(n,o,m,i,t,_){const f=r("v-btn"),S=r("v-toolbar-title"),V=r("v-spacer"),w=r("v-toolbar-items"),g=r("v-toolbar"),h=r("v-select"),d=r("v-col"),u=r("v-text-field"),b=r("v-row"),D=r("v-form"),k=r("v-container"),C=r("v-card"),a=r("v-dialog");return c(),y(b,{justify:"start",class:"py-2"},{default:l(()=>[e(a,{modelValue:t.dialog,"onUpdate:modelValue":o[8]||(o[8]=s=>t.dialog=s),scrim:!1,transition:"dialog-bottom-transition",persistent:"",style:{"max-width":"50rem"}},{activator:l(({props:s})=>[e(f,K({color:"blue-lighten-1"},s,{"prepend-icon":"mdi-plus",size:"small"}),{default:l(()=>[p(" Add Device ")]),_:2},1040)]),default:l(()=>[e(C,null,{default:l(()=>[e(g,{color:"white",class:"border-b"},{default:l(()=>[e(S,null,{default:l(()=>[p("Add Device")]),_:1}),e(V),e(w,null,{default:l(()=>[e(f,{variant:"text",onClick:o[0]||(o[0]=s=>t.dialog=!1)},{default:l(()=>[p(" cancel ")]),_:1})]),_:1})]),_:1}),e(k,null,{default:l(()=>[e(D,{onSubmit:B(_.create,["prevent"])},{default:l(()=>[e(b,null,{default:l(()=>[e(d,null,{default:l(()=>[e(d,{cols:"12"},{default:l(()=>[e(h,{label:"Category*",required:"",items:m.categories.map(s=>({title:s.name,value:s.id})),modelValue:t.form.category_id,"onUpdate:modelValue":o[1]||(o[1]=s=>t.form.category_id=s)},null,8,["items","modelValue"])]),_:1}),e(d,{cols:"12"},{default:l(()=>[e(u,{label:"Brand*",required:"",modelValue:t.form.brand,"onUpdate:modelValue":o[2]||(o[2]=s=>t.form.brand=s),error:!!i.errors.brand,"error-messages":i.errors.brand},null,8,["modelValue","error","error-messages"])]),_:1}),e(d,{cols:"12"},{default:l(()=>[e(u,{label:"Device Model*",required:"",modelValue:t.form.model,"onUpdate:modelValue":o[3]||(o[3]=s=>t.form.model=s),error:!!i.errors.model,"error-messages":i.errors.model},null,8,["modelValue","error","error-messages"])]),_:1}),e(d,{cols:"12",class:"date"},{default:l(()=>{var s;return[Q,q(v("input",{id:"date",type:"date","onUpdate:modelValue":o[4]||(o[4]=x=>t.form.date_purchased=x)},null,512),[[L,t.form.date_purchased]]),(s=t.form.errors)!=null&&s.date_purchased?(c(),A("p",W,E(t.form.errors.date_purchased),1)):I("",!0)]}),_:1})]),_:1}),e(d,null,{default:l(()=>[e(d,{cols:"12"},{default:l(()=>[e(u,{label:"Accountability Number*",modelValue:t.form.accountability_no,"onUpdate:modelValue":o[5]||(o[5]=s=>t.form.accountability_no=s),error:!!i.errors.accountability_no,"error-messages":i.errors.accountability_no},null,8,["modelValue","error","error-messages"])]),_:1}),e(d,{cols:"12"},{default:l(()=>[e(u,{label:"Serial Number",hint:"usally found at the back of your device",modelValue:t.form.serial_no,"onUpdate:modelValue":o[6]||(o[6]=s=>t.form.serial_no=s)},null,8,["modelValue"])]),_:1}),e(d,{cols:"12"},{default:l(()=>[e(u,{label:"MK Tag Number",modelValue:t.form.mk_tag_no,"onUpdate:modelValue":o[7]||(o[7]=s=>t.form.mk_tag_no=s)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(b,null,{default:l(()=>[e(d,{cols:"12"},{default:l(()=>[X,(c(!0),A(O,null,F(t.additionalData,(s,x)=>(c(),y(u,{key:x,label:s.title,modelValue:s.value,"onUpdate:modelValue":J=>s.value=J},null,8,["label","modelValue","onUpdate:modelValue"]))),128))]),_:1})]),_:1}),e(d,{cols:"12"},{default:l(()=>[e(f,{block:"",variant:"flat",color:"blue-lighten-1",type:"submit",loading:i.isLoading},{default:l(()=>[p("Create Item")]),_:1},8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const Z=T(H,[["render",Y]]),$={setup(){const n=N(),{errors:o,isLoading:m}=U(n);return{errors:o,isLoading:m,itemStore:n}},props:{categories:Array,item:Object},data(){return{dialog:!1,form:{brand:this.item.brand,model:this.item.model,serial_no:this.item.serial_no,mk_tag_no:this.item.mk_tag_no,date_purchased:this.item.date_purchased,accountability_no:this.item.accountability_no,category_id:this.item.category_id,status:this.item.status},additionalData:JSON.parse(this.item.json_attr)}},emits:["close","change"],methods:{async update(){this.form={...this.form,json_attr:JSON.stringify(this.additionalData)},await this.itemStore.updateItem(this.item.id,this.form),Object.keys(this.errors).length||this.$emit("change")}}},ee=v("label",{for:"date"},"Purchased Date*",-1),oe={key:0},te=v("h3",{class:"text-overline"},"Additional Data",-1);function le(n,o,m,i,t,_){const f=r("v-toolbar-title"),S=r("v-spacer"),V=r("v-btn"),w=r("v-toolbar-items"),g=r("v-toolbar"),h=r("v-select"),d=r("v-col"),u=r("v-text-field"),b=r("v-row"),D=r("v-form"),k=r("v-container"),C=r("v-card");return c(),y(C,null,{default:l(()=>[e(g,{color:"white",class:"border-b"},{default:l(()=>[e(f,null,{default:l(()=>[p("Add Device")]),_:1}),e(S),e(w,null,{default:l(()=>[e(V,{variant:"text",onClick:o[0]||(o[0]=a=>n.$emit("close"))},{default:l(()=>[p(" cancel ")]),_:1})]),_:1})]),_:1}),e(k,null,{default:l(()=>[e(D,{onSubmit:B(_.update,["prevent"])},{default:l(()=>[e(b,null,{default:l(()=>[e(d,null,{default:l(()=>[e(d,{cols:"12"},{default:l(()=>[e(h,{label:"Category*",required:"",items:m.categories.map(a=>({title:a.name,value:a.id})),modelValue:t.form.category_id,"onUpdate:modelValue":o[1]||(o[1]=a=>t.form.category_id=a)},null,8,["items","modelValue"])]),_:1}),e(d,{cols:"12"},{default:l(()=>[e(u,{label:"Brand*",required:"",modelValue:t.form.brand,"onUpdate:modelValue":o[2]||(o[2]=a=>t.form.brand=a),error:!!i.errors.brand,"error-messages":i.errors.brand},null,8,["modelValue","error","error-messages"])]),_:1}),e(d,{cols:"12"},{default:l(()=>[e(u,{label:"Device Model*",required:"",modelValue:t.form.model,"onUpdate:modelValue":o[3]||(o[3]=a=>t.form.model=a),error:!!i.errors.model,"error-messages":i.errors.model},null,8,["modelValue","error","error-messages"])]),_:1}),e(d,{cols:"12",class:"date"},{default:l(()=>{var a;return[ee,q(v("input",{id:"date",type:"date","onUpdate:modelValue":o[4]||(o[4]=s=>t.form.date_purchased=s)},null,512),[[L,t.form.date_purchased]]),(a=t.form.errors)!=null&&a.date_purchased?(c(),A("p",oe,E(t.form.errors.date_purchased),1)):I("",!0)]}),_:1})]),_:1}),e(d,null,{default:l(()=>[e(d,{cols:"12"},{default:l(()=>[e(u,{label:"Accountability Number*",modelValue:t.form.accountability_no,"onUpdate:modelValue":o[5]||(o[5]=a=>t.form.accountability_no=a),error:!!i.errors.accountability_no,"error-messages":i.errors.accountability_no},null,8,["modelValue","error","error-messages"])]),_:1}),e(d,{cols:"12"},{default:l(()=>[e(u,{label:"Serial Number",hint:"usally found at the back of your device",modelValue:t.form.serial_no,"onUpdate:modelValue":o[6]||(o[6]=a=>t.form.serial_no=a)},null,8,["modelValue"])]),_:1}),e(d,{cols:"12"},{default:l(()=>[e(u,{label:"MK Tag Number",modelValue:t.form.mk_tag_no,"onUpdate:modelValue":o[7]||(o[7]=a=>t.form.mk_tag_no=a)},null,8,["modelValue"])]),_:1}),e(d,{cols:"12"},{default:l(()=>[e(h,{label:"Device Status",items:["good","fair","bad","for disposal","disposed"],modelValue:t.form.status,"onUpdate:modelValue":o[8]||(o[8]=a=>t.form.status=a)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(b,null,{default:l(()=>[e(d,{cols:"12"},{default:l(()=>[te,(c(!0),A(O,null,F(t.additionalData,(a,s)=>(c(),y(u,{key:s,label:a.title,modelValue:a.value,"onUpdate:modelValue":x=>a.value=x},null,8,["label","modelValue","onUpdate:modelValue"]))),128))]),_:1})]),_:1}),e(d,{cols:"12"},{default:l(()=>[e(V,{block:"",variant:"flat",color:"blue-lighten-1",type:"submit",loading:i.isLoading},{default:l(()=>[p("Update Item")]),_:1},8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})}const ae=T($,[["render",le]]);const re={async setup(){const n=N(),o=M();await n.getItems(),await o.getUser();const{items:m}=U(n),{user:i}=U(o),t=await axios.get("/api/category"),_=R(t.data.data),f=j();return{user:i,items:m,categories:_,employeeInventoryStore:f,itemStore:n}},components:{VDataTable:G,Create:Z,Edit:ae,Associate:P,Chip:z},data(){return{search:"",Associate:{dialog:!1,data:[]},Edit:{dialog:!1,data:[]},headers:[{key:"brand",title:"Brand"},{key:"model",title:"Model"},{key:"status",title:"Status"},{key:"accountability_no",title:"Accountability No."},{key:"employee_name",title:"Active user"},{key:"location_from",title:"From"},{key:"location_name",title:"To"},{key:"actions",title:"",sortable:!1}]}},computed:{itemDataTable(){return this.items.map(n=>{var o,m,i;return{...n,category:n.category.name,category_id:n.category.id,employee_name:(o=n.owned_by_employee)==null?void 0:o.full_name,employee_id:(m=n.owned_by_employee)==null?void 0:m.id,location_id:(i=n.employee_inventories.at(0).by_location)==null?void 0:i.id,location_name:n.employee_inventories.length?n.employee_inventories.at(0).by_location.name:null,location_from:n.employee_inventories.length>=2?n.employee_inventories.at(1).by_location.name:null}})}},methods:{async fetchCategories(){try{const n=await axios.get("/api/category");this.categories=n.data.data}catch{}},async surrender(n){this.employeeInventoryStore.postEmployeeInventories({transferred_date:new Date().toISOString().split("T")[0],officer_in_charge:"Manuelito Dayrit",is_active:0,item_id:n.id,employee_id:n.employee_id,location_id:1})}}};function ne(n,o,m,i,t,_){const f=r("Create"),S=r("v-spacer"),V=r("v-text-field"),w=r("v-card-title"),g=r("v-btn"),h=r("Chip"),d=r("router-link"),u=r("VDataTable"),b=r("v-card"),D=r("Associate"),k=r("v-dialog"),C=r("Edit");return c(),A(O,null,[v("div",null,[e(f,{categories:i.categories},null,8,["categories"])]),e(b,null,{default:l(()=>[e(w,null,{default:l(()=>[p(" Items "),e(S),e(V,{modelValue:t.search,"onUpdate:modelValue":o[0]||(o[0]=a=>t.search=a),"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},null,8,["modelValue"])]),_:1}),e(u,{headers:t.headers,items:_.itemDataTable,search:t.search,style:{"overflow-y":"hidden"}},{"item.actions":l(({item:a})=>[a.selectable.location_id===1||!a.selectable.owned_by_employee?(c(),y(g,{key:0,onClick:()=>{t.Associate.data=a,t.Associate.dialog=!0},variant:"flat",class:"text-blue-lighten-1",icon:"mdi-swap-horizontal"},null,8,["onClick"])):(c(),y(g,{key:1,icon:"mdi-cancel",variant:"flat",class:"text-red-lighten-1",onClick:()=>_.surrender(a.selectable),loading:i.employeeInventoryStore.isLoading},null,8,["onClick","loading"])),a.selectable.id?(c(),y(g,{key:2,to:{name:"show",params:{showable:"item",id:a.selectable.id}},icon:"mdi-information-outline",variant:"flat"},null,8,["to"])):I("",!0),e(g,{icon:"mdi-pencil-outline",variant:"flat",onClick:()=>{t.Edit.dialog=!0,t.Edit.data=a.selectable}},null,8,["onClick"])]),"item.status":l(({item:a})=>[e(h,{list:a.selectable.status,listType:"condition"},null,8,["list"])]),"item.employee_name":l(({item:a})=>[v("td",null,[a.selectable.employee_id?(c(),y(d,{key:0,to:{name:"show",params:{showable:"employee",id:a.selectable.employee_id}},class:"text-blue-lighten-1"},{default:l(()=>[p(E(a.columns.employee_name),1)]),_:2},1032,["to"])):I("",!0)])]),_:1},8,["headers","items","search"])]),_:1}),e(k,{modelValue:t.Associate.dialog,"onUpdate:modelValue":o[3]||(o[3]=a=>t.Associate.dialog=a)},{default:l(()=>[e(D,{onClose:o[1]||(o[1]=a=>t.Associate.dialog=!1),onChange:o[2]||(o[2]=()=>{t.Associate.dialog=!1,i.itemStore.getItems()}),item:t.Associate.data.selectable,user:i.user},null,8,["item","user"])]),_:1},8,["modelValue"]),e(k,{modelValue:t.Edit.dialog,"onUpdate:modelValue":o[6]||(o[6]=a=>t.Edit.dialog=a)},{default:l(()=>[e(C,{onClose:o[4]||(o[4]=a=>t.Edit.dialog=!1),onChange:o[5]||(o[5]=()=>{t.Edit.dialog=!1,i.itemStore.getItems()}),categories:i.categories,item:t.Edit.data},null,8,["categories","item"])]),_:1},8,["modelValue"])],64)}const _e=T(re,[["render",ne],["__scopeId","data-v-4cba3361"]]);export{_e as default};
